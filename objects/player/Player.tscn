[gd_scene load_steps=11 format=2]

[ext_resource path="res://scripts/player/Player.gd" type="Script" id=2]
[ext_resource path="res://particles/dust.tscn" type="PackedScene" id=3]
[ext_resource path="res://particles/polution.tscn" type="PackedScene" id=4]
[ext_resource path="res://fonts/PressStart2P.ttf" type="DynamicFontData" id=5]
[ext_resource path="res://graphics/Player/fox_animation.png" type="Texture" id=6]

[sub_resource type="GDScript" id=1]
script/source = "extends Particles2D

func _ready():
	Controller.connect(\"speed_change\", self, \"on_speed_change\")
	
	
func on_speed_change(speed : float) -> void:
	
	speed_scale = speed / 2
"

[sub_resource type="Animation" id=5]
resource_name = "Player_Running"
loop = true
step = 0.06
tracks/0/type = "value"
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 0
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0, 0.06, 0.12, 0.18, 0.24, 0.3, 0.36, 0.42, 0.48, 0.54, 0.6, 0.66, 0.72, 0.78, 0.84, 0.9 ),
"transitions": PoolRealArray( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 ),
"update": 1,
"values": [ 0, 1, 2, 3, 4, 5, 6, 7, 7, 6, 5, 4, 3, 2, 1, 0 ]
}

[sub_resource type="GDScript" id=2]
script/source = "extends Camera2D
# Script to change the zoom when changing the window size


# The height of the game
var height : int = 180
var max_width_factor : float = 4

# Called when the node enters the scene tree for the first time.
func _ready() -> void:
	# On window resize also call size_changed
	get_tree().get_root().connect(\"size_changed\", self, \"_resize\")
	_resize()

# Function to rescale the viewport to fit the window size
func set_map_size() -> void:

	# To make up for the changed size, we need to zoom our camera out / in
	zoom = Vector2(1,1) * (height / max(0.1, get_viewport_rect().size.y))
	offset.x = (get_viewport_rect().size.x * 0.3)*zoom.x
	
	$\"../PlayerGUI\".scale = Vector2(1,1)/zoom/1.5



# Called on resize for full responsiveness
func _resize() -> void:
	
	# Our current method would prevent maximum size on maximize, so we allow every resolution on maximize
	if OS.window_maximized:
		OS.max_window_size = Vector2(0, 0)
		OS.window_maximized = false
		OS.window_maximized = true
	else:
		# Prevent the aspect ratio being too wide
		OS.max_window_size = Vector2(OS.window_size.y*max_width_factor, 1000000)
	
	set_map_size()

"

[sub_resource type="DynamicFont" id=3]
size = 8
outline_size = 1
outline_color = Color( 0, 0, 0, 1 )
font_data = ExtResource( 5 )

[sub_resource type="GDScript" id=4]
script/source = "extends Particles2D

func _ready():
	Controller.connect(\"speed_change\", self, \"on_speed_change\")
	
	
func on_speed_change(speed : float) -> void:
	
	if speed == 0:
		speed_scale = 0
	else:
		speed_scale = 1
"

[node name="Player" type="Node2D"]
scale = Vector2( 2.5, 2.5 )
script = ExtResource( 2 )

[node name="Area2D" type="Area2D" parent="."]

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="Area2D"]
polygon = PoolVector2Array( 11.0075, -10.611, 14.2473, -8.74812, 19.9169, -4.61739, 22.5898, -1.53959, 22.5898, 0.728258, 13.3564, 8.98972, 10.2786, 8.98972, 8.41568, 5.83093, -6.64934, 5.66894, -12.8049, 4.53501, -11.0231, -6.31828, 6.95777, -6.80425 )

[node name="dust" parent="." instance=ExtResource( 3 )]
speed_scale = 0.5
script = SubResource( 1 )

[node name="default" type="Sprite" parent="."]
position = Vector2( -1.95804, -0.559438 )
texture = ExtResource( 6 )
hframes = 8

[node name="AnimationPlayer" type="AnimationPlayer" parent="default"]
playback_speed = 1.3
anims/Player_Running = SubResource( 5 )

[node name="Camera2D" type="Camera2D" parent="."]
offset = Vector2( 100, 0 )
current = true
script = SubResource( 2 )

[node name="PlayerGUI2" type="CanvasLayer" parent="."]

[node name="Label" type="Label" parent="PlayerGUI2"]
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
margin_top = -8.0
rect_scale = Vector2( 4, 4 )
rect_pivot_offset = Vector2( -5.18, 11.61 )
size_flags_vertical = 0
custom_fonts/font = SubResource( 3 )
text = "Current Score: 69"
__meta__ = {
"_edit_use_anchors_": false
}

[node name="PlayerGUI" type="CanvasLayer" parent="."]
follow_viewport_scale = 5.0

[node name="Polutedsmoke" parent="PlayerGUI" instance=ExtResource( 4 )]
position = Vector2( -123.31, -90 )
scale = Vector2( 2.5, 2.5 )
visibility_rect = Rect2( -60, -20, 200, 250 )
script = SubResource( 4 )

[node name="HeartContainerMargin" type="MarginContainer" parent="PlayerGUI"]
margin_top = 0.814514
margin_right = 100.0
margin_bottom = 40.8145
custom_constants/margin_right = 5
custom_constants/margin_top = 5
custom_constants/margin_left = 5
custom_constants/margin_bottom = 5
__meta__ = {
"_edit_use_anchors_": false
}

[node name="HeartCon" type="HBoxContainer" parent="PlayerGUI/HeartContainerMargin"]
margin_left = 5.0
margin_top = 5.0
margin_right = 95.0
margin_bottom = 34.0
custom_constants/separation = 5
__meta__ = {
"_edit_use_anchors_": false
}

[node name="Tween" type="Tween" parent="."]
